jQuery(function(){"use strict"}),function(a,b){"use strict";a.CoEnvFw=function(b,c){this.options=b,this.element=a(c),this._init(b)},a.CoEnvFw.settings={ajaxobject:b.coenvfw,ajaxurl:b.coenvfw.ajaxurl,facultyEndpoint:b.coenvfw.facultyEndpoint,memberLimit:25,filters:{themes:["all"],units:["all"]}},a.CoEnvFw.prototype._init=function(b){var c=this;this.options=a.extend(!0,{},a.CoEnvFw.settings,b),this.transientKey=this.element.attr("id"),this.filters=this.options.filters,this._getFaculty().then(function(){c._renderMembers(),c._cacheMembers()})},a.CoEnvFw.prototype._getFaculty=function(){var b,c,d,e=new a.Deferred,f=this;return b=this.filters.themes.join("&")||"all",c=this.filters.units.join("&")||"all",d=f.options.facultyEndpoint,d=d.replace("themes/all","themes/"+b),d=d.replace("units/all","units/"+c),a.ajax({url:d,dataType:"jsonp",success:function(a){f.members=f._prepareMemberObjects(a),e.resolve()},error:function(a,b){f._failed(b),e.reject()}}),e.promise()},a.CoEnvFw.prototype._prepareMemberObjects=function(b){var c=[];return a.each(b,function(){c.push({permalink:this.permalink,name:this.full_name,image:this.images.thumbnail.url,color:this.units[0].color})}),c},a.CoEnvFw.prototype._renderMembers=function(){},a.CoEnvFw.prototype._cacheMembers=function(){var b=this,c={action:"coenv_faculty_widget_cache_members",members:this.members,transient_key:this.transientKey};a.ajax({url:this.options.ajaxurl,data:c,type:"POST",success:function(a){console.log(a)},error:function(a,c){b._failed(c)}})},a.CoEnvFw.prototype._failed=function(a){console.log(a)},a.CoEnvFw.prototype._getMembers=function(){var b=new a.Deferred,c=this,d={action:"coenv_faculty_widget_get_cached_members"};return a.post(this.options.ajaxurl,d,function(d){"false"!==d?(c.members=a.parseJSON(d),b.resolve()):c._remoteGetMembers().then(function(){b.resolve()})}),b.promise()},a.CoEnvFw.prototype.__renderMembers=function(){var b=this.members,c='<p><span class="'+this.options.feedbackNumberClass+'">'+b.length+'</span> faculty working on <a href="#">Environmental Chemistry</a></p>',d=[],e=this,f=0;this.$feedback.html(c),a.each(b,function(){if(25!==f){var b=this,c=a("<li></li>"),g=a("<a></a>"),h=a("<img />"),i=a("<p></p>");c.addClass(e.options.memberClass),c.attr("style","background-color: "+b.color+";"),g.addClass(e.options.memberInnerClass),g.attr("href",b.permalink),h.addClass(e.options.memberImageClass),h.attr("src",b.image),h.appendTo(g),i.addClass(e.options.memberNameClass),i.text(b.full_name),i.appendTo(g),g.appendTo(c),d.push(c),f++}}),this.$resultsList.append(d)},a.CoEnvFw.prototype.option=function(b){a.isPlainObject(b)&&(this.options=a.extend(!0,this.options,b))},a.fn.coenvfw=function(b){if("string"==typeof b){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=a.data(this,"coenvfw");return d?a.isFunction(d[b])&&"_"!==b.charAt(0)?(d[b].apply(d,c),void 0):(console.log("error","no such method "+b+" for coenvfw instance"),void 0):(console.log("error","cannot call methods on coenvfw prior to initialization. attempted to call method "+b),void 0)})}else this.each(function(){var c=a.data(this,"coenvfw");c?(c.option(b||{}),c._init()):a.data(this,"coenvfw",new a.CoEnvFw(b,this))});return this}}(jQuery,window,document);