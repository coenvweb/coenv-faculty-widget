jQuery(function(){"use strict"}),function(a,b){"use strict";a.CoEnvFw=function(b,c){this.options=b,this.element=a(c),this._init(b)},a.CoEnvFw.settings={ajaxobject:b.coenvfw,ajaxurl:b.coenvfw.ajaxurl,facultyUrl:b.coenvfw.facultyUrl,facultyEndpoint:b.coenvfw.facultyEndpoint,memberLimit:25,filters:{themes:["all"],units:["all"]}},a.CoEnvFw.prototype._init=function(b){var c=this;this.options=a.extend(!0,{},a.CoEnvFw.settings,b),this.transientKey=this.element.attr("id"),this.filters=this.options.filters,this._getMembers().then(function(){c._renderMembers(),c._renderFeedback(),c._cacheMembers()})},a.CoEnvFw.prototype._getMembers=function(){var b,c,d,e=new a.Deferred,f=this;return b=this.filters.themes.join("&")||"all",c=this.filters.units.join("&")||"all",d=f.options.facultyEndpoint,d=d.replace("themes/all","themes/"+b),d=d.replace("units/all","units/"+c),a.ajax({url:d,dataType:"jsonp",success:function(a){f.members=f._prepareMemberObjects(a),e.resolve()},error:function(a,b){f._failed(b),e.reject()}}),e.promise()},a.CoEnvFw.prototype._prepareMemberObjects=function(b){var c=[],d=0;return a.each(b,function(){25!==d&&(c.push({permalink:this.permalink,name:this.full_name,image:this.images.thumbnail.url,color:this.units[0].color}),d++)}),{total:b.length,results:c}},a.CoEnvFw.prototype._renderMembers=function(){var b,c;b=Handlebars.compile(a("#tmpl-members").text()),c=b({Members:this.members.results}),this.element.find(".coenv-fw-results").append(c)},a.CoEnvFw.prototype._renderFeedback=function(){var b=this,c=this.element.find(".coenv-fw-feedback"),d=c.find(".coenv-fw-feedback-number"),e=c.find(".coenv-fw-feedback-message"),f={action:"coenv_faculty_widget_prepare_feedback",faculty:this.members,theme:this.filters.themes[0],unit:this.filters.units[0]};a.ajax({url:this.options.ajaxurl,data:f,type:"POST",success:function(a){d.text(b.members.total),e.html(a)},error:function(){}})},a.CoEnvFw.prototype._cacheMembers=function(){var b=this,c={action:"coenv_faculty_widget_cache_members",members:this.members,transient_key:this.transientKey};a.ajax({url:this.options.ajaxurl,data:c,type:"POST",success:function(){},error:function(a,c){b._failed(c)}})},a.CoEnvFw.prototype._failed=function(){},a.CoEnvFw.prototype.option=function(b){a.isPlainObject(b)&&(this.options=a.extend(!0,this.options,b))},a.fn.coenvfw=function(b){if("string"==typeof b){var c=Array.prototype.slice.call(arguments,1);this.each(function(){var d=a.data(this,"coenvfw");return d?a.isFunction(d[b])&&"_"!==b.charAt(0)?(d[b].apply(d,c),void 0):(console.log("error","no such method "+b+" for coenvfw instance"),void 0):(console.log("error","cannot call methods on coenvfw prior to initialization. attempted to call method "+b),void 0)})}else this.each(function(){var c=a.data(this,"coenvfw");c?(c.option(b||{}),c._init()):a.data(this,"coenvfw",new a.CoEnvFw(b,this))});return this}}(jQuery,window,document);
//# sourceMappingURL=../maps/main.js.map